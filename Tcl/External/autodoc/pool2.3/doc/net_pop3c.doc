# -*- tcl -*-
newPage    pop3c.htm "Description of POP3 client core"
#add2Sidebar pop3c.htm "Popeye"

xrefDef p3c_smps "postscript" p3c.ps

par "
The client core is derived from the [classRef pop3Connection] class handling
the details of command/reply-exchanges following the client side of the POP3
protocol. The overall handling of a complete pop session, including recovery
from errors, is built on top of that. However, the decision what mails to load
from the server is delegated to an external object following the interface
laid down in [classRef popClientMsgClassificatorBase]. Base of the decision
are the mail headers. The classificator is given to the core through the
specification of the option [optionRef pop3Client classificator]. The task of
storing the messages which were loaded from the server is outsourced as well.
Here the option [optionRef pop3Client storage] is used to specify the actual
storage object, which has to be derived from [classRef popClientStorageBase].
"

par "
Currently only one classificator is implemented, [classRef acceptEverything].
From the name alone it should be clear that this classificator actually does
no classification at all. It alwas decides on retrieving the mail it was given.
"

par "
On the other hand we have six storage systems, namely [classRef dirStorage],
[classRef fileStorage], [classRef memStorage], [classRef multiStorage],
[classRef smtpStorage] and  [classRef triggerStorage].
"

par "
[fileRef apps/popeye] is a complete pop client built around this core, using
the all accepting classificator and all storage systems with the exception of
[classRef fileStorage]. The structure is as in the following image"

par align=center "[imgRef pop3_current]"

par "The functionality of [classRef triggerStorage] is used to start a flist
operation in my mailreader, which is [xRef ExMH], created by [xRef Welch],
also written in [depRef Tcl]. This operation scans all known mail folders for
new mail which is then displayed. Without that [xRef ExMH] would have to poll
every so often to be up to date."

par "The statemachine used by [classRef pop3Client] to control the pop session
looks like this:"

par align=center "[imgRef pop3_statem]"

par "
This image is available as [xRef p3c_smps] too. It should be read together
with the actual code.
"

closePage
